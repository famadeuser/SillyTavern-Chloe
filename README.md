# Chloe - å¢å¼ºç‰ˆ SillyTavern

åŸºäº [SillyTavern](https://github.com/SillyTavern/SillyTavern) çš„å¢å¼ºç‰ˆæœ¬ï¼Œæ·»åŠ äº† OAuth ç™»å½•ã€ç”¨æˆ·ç®¡ç†å’Œç§¯åˆ†ç³»ç»Ÿã€‚

## âœ¨ æ–°å¢åŠŸèƒ½

### ğŸ” OAuth ç™»å½•ç³»ç»Ÿ
- æ”¯æŒ Discord OAuth ç™»å½•
- æ”¯æŒ LinuxDo OAuth ç™»å½•
- å®‰å…¨çš„çŠ¶æ€éªŒè¯å’Œä¼šè¯ç®¡ç†
- è‡ªåŠ¨åˆ›å»ºç”¨æˆ·è´¦æˆ·

### ğŸ‘¥ ç”¨æˆ·è´¦æˆ·ç³»ç»Ÿ
- å¤šç”¨æˆ·æ”¯æŒï¼Œæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨
- ç”¨æˆ·ç§¯åˆ†ç³»ç»Ÿ
- ç­¾åˆ°åŠŸèƒ½
- å…‘æ¢ç ç³»ç»Ÿ

### ğŸ¨ ç”¨æˆ·ç•Œé¢å¢å¼º
- ç°ä»£åŒ–çš„ç™»å½•é¡µé¢ï¼ˆ`/oauth.html`ï¼‰
- ç”¨æˆ·ä¸»é¡µç•Œé¢ï¼ˆ`/home.html`ï¼‰
- ç®¡ç†å‘˜æ§åˆ¶é¢æ¿ï¼ˆ`/admin.html`ï¼‰
- åƒç´ é£æ ¼è®¾è®¡

### âš™ï¸ ç®¡ç†åŠŸèƒ½
- ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥çœ‹ã€åˆ é™¤ã€é‡ç½®å¯†ç ï¼‰
- å…‘æ¢ç ç®¡ç†ï¼ˆç”Ÿæˆã€æŸ¥çœ‹ä½¿ç”¨æƒ…å†µï¼‰
- æ³¨å†Œå¼€å…³æ§åˆ¶
- ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

## ğŸ–¼ï¸ ç•Œé¢ä¸€è§ˆ

### OAuth ç™»å½•é¡µé¢
![OAuthç™»å½•é¡µé¢](https://youke1.picui.cn/s1/2025/11/13/6914bae697ddf.jpg)

### ç”¨æˆ·ä¸»é¡µ - ä»ªè¡¨ç›˜
![ç”¨æˆ·ä¸»é¡µ](https://youke1.picui.cn/s1/2025/11/13/6914bae709c2f.jpg)

### ç­¾åˆ°åŠŸèƒ½
![ç­¾åˆ°åŠŸèƒ½](https://youke1.picui.cn/s1/2025/11/13/6914bae9a8473.jpg)

### å…‘æ¢ç ä½¿ç”¨
![å…‘æ¢ç ](https://youke1.picui.cn/s1/2025/11/13/6914baeaa50a6.jpg)

### ä½¿ç”¨è¯´æ˜
![ä½¿ç”¨è¯´æ˜](https://youke1.picui.cn/s1/2025/11/13/6914baec59638.jpg)

### ç®¡ç†å‘˜åå° - ç™»å½•
![ç®¡ç†å‘˜ç™»å½•](https://youke1.picui.cn/s1/2025/11/13/6914baef3430a.jpg)

### ç®¡ç†å‘˜åå° - ä»ªè¡¨ç›˜
![ç®¡ç†å‘˜ä»ªè¡¨ç›˜](https://youke1.picui.cn/s1/2025/11/13/6914baf1b669b.jpg)

### ç”¨æˆ·ç®¡ç†
![ç”¨æˆ·ç®¡ç†](https://youke1.picui.cn/s1/2025/11/13/6914baf61298a.jpg)

### å…‘æ¢ç ç®¡ç†
![å…‘æ¢ç ç®¡ç†](https://youke1.picui.cn/s1/2025/11/13/6914baf7cd36b.jpg)

### ç³»ç»Ÿè®¾ç½®
![ç³»ç»Ÿè®¾ç½®](https://youke1.picui.cn/s1/2025/11/13/6914baf9b3a4f.jpg)

### èŠå¤©ç•Œé¢ - ä¸»ç•Œé¢
![èŠå¤©ä¸»ç•Œé¢](https://youke1.picui.cn/s1/2025/11/13/6914bafc66619.jpg)

### è§’è‰²é€‰æ‹©
![è§’è‰²é€‰æ‹©](https://youke1.picui.cn/s1/2025/11/13/6914bafdb5beb.jpg)

### å¯¹è¯ç¤ºä¾‹ 1
![å¯¹è¯ç¤ºä¾‹1](https://youke1.picui.cn/s1/2025/11/13/6914baff164c8.jpg)

### å¯¹è¯ç¤ºä¾‹ 2
![å¯¹è¯ç¤ºä¾‹2](https://youke1.picui.cn/s1/2025/11/13/6914bb02eb396.jpg)

### è®¾ç½®é¢æ¿
![è®¾ç½®é¢æ¿](https://youke1.picui.cn/s1/2025/11/13/6914bb04708db.jpg)

### è§’è‰²å¡ç‰‡ç¼–è¾‘
![è§’è‰²ç¼–è¾‘](https://youke1.picui.cn/s1/2025/11/13/6914bb07af7a7.jpg)

### ä¸–ç•Œä¹¦è®¾ç½®
![ä¸–ç•Œä¹¦](https://youke1.picui.cn/s1/2025/11/13/6914bb0958858.jpg)

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Node.js 18 æˆ–æ›´é«˜ç‰ˆæœ¬
- è‡³å°‘ 4GB RAM
- 10GB å¯ç”¨ç£ç›˜ç©ºé—´

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®

å¤åˆ¶ `default/config.yaml` åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `config.yaml`ï¼Œå¹¶æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®ï¼š

```yaml
# å¯ç”¨å¤šç”¨æˆ·æ¨¡å¼
enableUserAccounts: true

# OAuth é…ç½®
oauth:
  redirectUri: 'https://your-domain.com/oauth'
  discord:
    clientId: 'YOUR_DISCORD_CLIENT_ID'
    clientSecret: 'YOUR_DISCORD_CLIENT_SECRET'
  linuxdo:
    clientId: 'YOUR_LINUXDO_CLIENT_ID'
    clientSecret: 'YOUR_LINUXDO_CLIENT_SECRET'
```

**âš ï¸ é‡è¦å®‰å…¨æç¤ºï¼š**
- è¯·ä¿®æ”¹ `src/endpoints/admin.js` ä¸­çš„ç®¡ç†å‘˜å‡­æ®
- ä¸è¦å°†åŒ…å«æ•æ„Ÿä¿¡æ¯çš„ `config.yaml` æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- ä½¿ç”¨å¼ºå¯†ç å’Œå®‰å…¨çš„å¯†é’¥

### 3. å¯åŠ¨æœåŠ¡

```bash
npm start
```

æœåŠ¡å°†åœ¨ `http://localhost:8000` å¯åŠ¨ã€‚

## ğŸ”§ é…ç½® OAuth

### Discord OAuth

1. è®¿é—® [Discord Developer Portal](https://discord.com/developers/applications)
2. åˆ›å»ºæ–°åº”ç”¨
3. åœ¨ OAuth2 è®¾ç½®ä¸­æ·»åŠ å›è°ƒ URLï¼š`https://your-domain.com/oauth`
4. å¤åˆ¶ Client ID å’Œ Client Secret åˆ°é…ç½®æ–‡ä»¶

### LinuxDo OAuth

1. åœ¨ LinuxDo å¹³å°ç”³è¯· OAuth åº”ç”¨
2. é…ç½®å›è°ƒ URLï¼š`https://your-domain.com/oauth`
3. å°†å‡­æ®æ·»åŠ åˆ°é…ç½®æ–‡ä»¶

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ oauth.js              # OAuth ç™»å½•é€»è¾‘
â”‚   â”œâ”€â”€ endpoints/
â”‚   â”‚   â”œâ”€â”€ admin.js          # ç®¡ç†å‘˜æ¥å£
â”‚   â”‚   â””â”€â”€ account.js        # ç”¨æˆ·è´¦æˆ·æ¥å£
â”‚   â””â”€â”€ ...
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ home.html             # ç”¨æˆ·ä¸»é¡µ
â”‚   â”œâ”€â”€ oauth.html            # OAuth ç™»å½•é¡µ
â”‚   â”œâ”€â”€ admin.html            # ç®¡ç†é¢æ¿
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ops/
â”‚   â””â”€â”€ Caddyfile             # Caddy åå‘ä»£ç†é…ç½®
â””â”€â”€ default/
    â””â”€â”€ config.yaml           # é…ç½®æ¨¡æ¿
```

## ğŸ› ï¸ å¼€å‘

```bash
# å¼€å‘æ¨¡å¼ï¼ˆå¸¦è°ƒè¯•ï¼‰
npm run debug

# ä»£ç æ£€æŸ¥
npm run lint

# è‡ªåŠ¨ä¿®å¤ä»£ç é£æ ¼
npm run lint:fix
```

## ğŸ³ Docker éƒ¨ç½²

```bash
docker compose -f docker/docker-compose.yml up -d
```

## ğŸ“š API ç«¯ç‚¹

### ç”¨æˆ·ç«¯ç‚¹
- `GET /api/account/info` - è·å–è´¦æˆ·ä¿¡æ¯
- `POST /api/account/checkin` - ç­¾åˆ°
- `POST /api/account/redeem` - ä½¿ç”¨å…‘æ¢ç 

### ç®¡ç†å‘˜ç«¯ç‚¹
- `GET /api/admin/users` - è·å–ç”¨æˆ·åˆ—è¡¨
- `POST /api/admin/redeem-codes` - ç”Ÿæˆå…‘æ¢ç 
- `POST /api/admin/toggle-registration` - åˆ‡æ¢æ³¨å†Œå¼€å…³

### OAuth ç«¯ç‚¹
- `GET /login/:provider` - å‘èµ· OAuth ç™»å½•
- `GET /oauth` - OAuth å›è°ƒå¤„ç†

## ğŸ”’ å®‰å…¨æ€§

1. **ç®¡ç†å‘˜å‡­æ®**ï¼šä¿®æ”¹ `src/endpoints/admin.js` ä¸­çš„ç¡¬ç¼–ç å‡­æ®
2. **CSRF ä¿æŠ¤**ï¼šç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿æŒå¯ç”¨
3. **SSL/TLS**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®å¯ç”¨ HTTPS
4. **å¯†é’¥ç®¡ç†**ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡å­˜å‚¨æ•æ„Ÿä¿¡æ¯

## ğŸ“– æ–‡æ¡£

è¯¦ç»†éƒ¨ç½²æ–‡æ¡£è¯·å‚è€ƒ [DEPLOYMENT.md](./DEPLOYMENT.md)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº AGPL-3.0 è®¸å¯è¯å¼€æºã€‚

## ğŸ™ è‡´è°¢

- [SillyTavern](https://github.com/SillyTavern/SillyTavern) - åŸå§‹é¡¹ç›®
- æ‰€æœ‰è´¡çŒ®è€…å’Œæ”¯æŒè€…

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ä½¿ç”¨æœ¬é¡¹ç›®æ‰€é€ æˆçš„ä¸€åˆ‡åæœç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚
